---
title: "4. Creating epochs"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{4. Creating epochs}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{knitr::rmarkdown}
editor: visual
editor_options:
  chunk_output_type: inline
---

> ðŸŽ¯ **GOALS**
>
> -   *Learn how to load EEG data into R*
> -   *Visually inspect the raw EEG signal*
> -   *Understand the basics of frequency-domain filtering*

## 5.1 Read epoched data

```{r, message=FALSE}
library(here)
library(eegUtils)
```

```{r}
bids_dir <- here("data", "n170")
deriv_dir <- here(bids_dir, "derivatives", "eegUtils", "sub-001", "eeg")
epoch_file <- here(deriv_dir, "sub-001_task-N170_desc-epoched_eeg.rds")
dat_basl <- readRDS(epoch_file)
```

## 5.2 Independent component analysis

```{r}
n_components <- 15
ica <- run_ICA(dat_basl, method = "fastica", pca = n_components)
```

```{r, eval=FALSE, message=FALSE}
view_ica(ica)
```

```{r}
heog <- c("HEOG_left", "HEOG_right")
veog <- c("FP2", "VEOG_lower")
(bad_components <- ar_eogcor(ica, dat_basl, heog, veog))
```

```{r}
heog <- c("HEOG_left", "HEOG_right")
veog <- c("FP2", "VEOG_lower")
(bad_components <- ar_eogcor(ica, dat_basl, heog, veog, threshold = 0.5))
```

```{r}
dat_icacor <- apply_ica(dat_basl, ica, comps = bad_components)
```

## 5.3 BESA

## 5.4 Regression

```{r}
dat_eogreg <- ar_eogreg(dat_basl, heog, veog)
```
