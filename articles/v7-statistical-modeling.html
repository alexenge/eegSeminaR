<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="eegSeminaR">
<title>7. Statistical modeling • eegSeminaR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="7. Statistical modeling">
<meta property="og:description" content="eegSeminaR">
<meta property="og:image" content="https://alexenge.github.io/eegSeminaR/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">eegSeminaR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2022.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/eegSeminaR.html">Get started</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-course-contents">Course contents</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-course-contents">
    <a class="dropdown-item" href="../articles/v1-introduction-to-r.html">1. Introduction to R</a>
    <a class="dropdown-item" href="../articles/v2-open-data.html">2. Open data</a>
    <a class="dropdown-item" href="../articles/v3-preprocessing.html">3. Preprocessing</a>
    <a class="dropdown-item" href="../articles/v4-creating-epochs.html">4. Creating epochs</a>
    <a class="dropdown-item" href="../articles/v5-removing-artifacts.html">5. Removing artifacts</a>
    <a class="dropdown-item" href="../articles/v6-extracting-amplitudes.html">6. Extracting amplitudes</a>
    <a class="dropdown-item" href="../articles/v7-statistical-modeling.html">7. Statistical modeling</a>
    <a class="dropdown-item" href="../articles/v8-making-plots.html">8. Making plots</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/alexenge/eegSeminaR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>7. Statistical modeling</h1>
            
            <h4 data-toc-skip class="date">2023-01-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/alexenge/eegSeminaR/blob/HEAD/vignettes/v7-statistical-modeling.Rmd" class="external-link"><code>vignettes/v7-statistical-modeling.Rmd</code></a></small>
      <div class="d-none name"><code>v7-statistical-modeling.Rmd</code></div>
    </div>

    
    
<blockquote>
<p>🎯 <strong>GOALS</strong></p>
<p><em>Testing if there is a statistically reliable difference in ERP
amplitudes (here: N170 component) between experimental conditions (here:
faces versus cars).</em></p>
</blockquote>
<div class="section level2">
<h2 id="intro-ants">7.1 Intro: Ants<a class="anchor" aria-label="anchor" href="#intro-ants"></a>
</h2>
<ul>
<li><p>Like ants, scientists can achieve amazing things if they
cooporate</p></li>
<li><p>But sometimes they get lost by blindly following one
another</p></li>
</ul>
<p><img src="images/ants.png"></p>
<p><em><strong>Figure:</strong> Ants being collectively clever and
collectively stupid.</em><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;strong&gt;Souce:&lt;/strong&gt; &lt;a href="https://imgur.com/KWXSw" class="external-link"&gt;Imgur&lt;/a&gt;, &lt;a href="https://www.youtube.com/watch?v=LEKwQxO4EZU" class="external-link"&gt;YouTube&lt;/a&gt;&lt;/p&gt;'><sup>1</sup></a></p>
</div>
<div class="section level2">
<h2 id="t-test">7.2 <em>t</em>-test<a class="anchor" aria-label="anchor" href="#t-test"></a>
</h2>
<ul>
<li><p>We’ll start with modeling data for a <strong>single
subject</strong> and move to a group analysis (inclduding all 40 ERP
CORE participants) in Section 7.4</p></li>
<li>
<p>Load required packages:</p>
<ul>
<li><p><code>lme4</code> for fitting linear mixed-effects models (see
Section 7.4)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Bates, D., Mächler, M., Bolker, B., &amp;amp; Walker, S.
(2015). Fitting linear mixed-effects models using lme4. &lt;em&gt;Journal of
Statistical Software&lt;/em&gt;, &lt;em&gt;67&lt;/em&gt;(1), 1–48. &lt;a href="https://doi.org/10.18637/jss.v067.i01" class="external-link uri"&gt;https://doi.org/10.18637/jss.v067.i01&lt;/a&gt;&lt;/p&gt;'><sup>2</sup></a></p></li>
<li><p><code>lmerTest</code> for obtaining <em>p</em> values for linear
mixed-effects models<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Kuznetsova, A., Brockhoff, P. B., &amp;amp; Christensen, R.
H. B. (2017). lmerTest package: Tests in linear mixed effects models.
&lt;em&gt;Journal of Statistical Software&lt;/em&gt;, &lt;em&gt;82&lt;/em&gt;(13), 1–26. &lt;a href="https://doi.org/10.18637/jss.v082.i13" class="external-link uri"&gt;https://doi.org/10.18637/jss.v082.i13&lt;/a&gt;&lt;/p&gt;'><sup>3</sup></a></p></li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/" class="external-link">here</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/" class="external-link">lme4</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/runehaubo/lmerTestR" class="external-link">lmerTest</a></span><span class="op">)</span></span></code></pre></div>
<ul>
<li>Load the single trial mean N170 amplitudes (= one micro-voltage per
trial):</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bids_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"data/n170"</span><span class="op">)</span></span>
<span><span class="va">deriv_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="va">bids_dir</span>, <span class="st">"derivatives/eegUtils/sub-001/eeg"</span><span class="op">)</span></span>
<span><span class="va">trials_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="va">deriv_dir</span>, <span class="st">"sub-001_task-N170_trials.csv"</span><span class="op">)</span></span>
<span><span class="va">dat_trials</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">trials_file</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat_trials</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   epoch stimulus condition amplitude</span></span>
<span><span class="co">## 1    72       41       car  1.077073</span></span>
<span><span class="co">## 2   105       41       car  2.541544</span></span>
<span><span class="co">## 3    30       42       car  4.097639</span></span>
<span><span class="co">## 4   108       42       car  2.521141</span></span>
<span><span class="co">## 5    26       43       car  4.541256</span></span>
<span><span class="co">## 6    61       44       car  8.356623</span></span></code></pre>
<ul>
<li>
<a href="https://en.wikipedia.org/wiki/Student%27s_t-test" class="external-link">Student’s
<em>t</em>-test</a> for the difference between <code>"car"</code> trials
and <code>"face"</code> trials:</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">amplitude</span> <span class="op">~</span> <span class="va">condition</span>, data <span class="op">=</span> <span class="va">dat_trials</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Welch Two Sample t-test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  amplitude by condition</span></span>
<span><span class="co">## t = 3.9289, df = 148.98, p-value = 0.0001302</span></span>
<span><span class="co">## alternative hypothesis: true difference in means between group car and group face is not equal to 0</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  1.386838 4.193319</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">##  mean in group car mean in group face </span></span>
<span><span class="co">##          2.6422692         -0.1478094</span></span></code></pre>
<ul>
<li>Conclusion: For participant <code>sub-001</code>, face images (as
compared to car images) elicit more negative voltages in the N170 time
range</li>
</ul>
</div>
<div class="section level2">
<h2 id="linear-regression">7.3 Linear regression<a class="anchor" aria-label="anchor" href="#linear-regression"></a>
</h2>
<ul>
<li><p>The <em>t</em>-test from Section 7.2 is identical to a simple
linear regression model</p></li>
<li>
<p>Define model formula:</p>
<ul>
<li>N170 <code>amplitude</code> is predicted (<code>~</code>) by an
intercept (<code>1</code>) and the <code>condition</code> effect (faces
vs. cars)</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">form_lm</span> <span class="op">&lt;-</span> <span class="va">amplitude</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">condition</span></span></code></pre></div>
<ul>
<li><p><code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> function implicitly codes <code>"car"</code>
trials with <code>0</code> and <code>"face"</code> trials with
<code>1</code></p></li>
<li><p>Intercept therefore is the average N170 voltage in car
trials</p></li>
<li><p>Predictor effect (<code>epoch_labelsface</code>) is the
difference between a face trial and a car trial</p></li>
<li><p>This effect explains 8.7% of the variance in the N170 (see <span class="math inline">\(R^2\)</span>)</p></li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">form_lm</span>, <span class="va">dat_trials</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = form_lm, data = dat_trials)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -9.9302 -2.5755 -0.8988  1.4419 17.6916 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)     2.6423     0.5039   5.244  5.3e-07 ***</span></span>
<span><span class="co">## conditionface  -2.7901     0.7103  -3.928  0.00013 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 4.364 on 149 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.09385,    Adjusted R-squared:  0.08777 </span></span>
<span><span class="co">## F-statistic: 15.43 on 1 and 149 DF,  p-value: 0.0001305</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="linear-mixed-effects-model">7.4 Linear mixed-effects model<a class="anchor" aria-label="anchor" href="#linear-mixed-effects-model"></a>
</h2>
<ul>
<li>
<p>Modeling the data from <strong>all participants</strong> (=
“group analysis”) requires a more complex model</p>
<ul>
<li><p>Trials from the same participant are correlated with one another
(due to individual differences, differences in cap position and
conductance, etc.)</p></li>
<li><p>Idea of <a href="https://en.wikipedia.org/wiki/Mixed_model" class="external-link"><strong>linear
mixed-effects models (LMMs)</strong></a>: Fit a separate linear
regression (as in section 7.3) for each participant and average the
regression coefficients<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;This is only true on a rough, conceptual level. In
reality, R doesn’t estimate separate regression coefficients for each
participant but rather just the &lt;em&gt;variance&lt;/em&gt; of these coefficients
across participants, using a iterative approach called (restricted) &lt;a href="https://towardsdatascience.com/probability-concepts-explained-maximum-likelihood-estimation-c7b4342fdbb1" class="external-link"&gt;maximum
likelihood estimation&lt;/a&gt;.&lt;/p&gt;'><sup>4</sup></a></p></li>
</ul>
</li>
<li><p>Read data frame with single trial mean N170 amplitudes from all
participants:</p></li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">group_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="va">bids_dir</span>, <span class="st">"derivatives/eegUtils/group_task-N170_trials.csv"</span><span class="op">)</span></span>
<span><span class="va">dat_group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">group_file</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat_group</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   participant epoch stimulus condition  amplitude</span></span>
<span><span class="co">## 1           1   105       41       car  2.1057134</span></span>
<span><span class="co">## 2           1     8       56       car -4.2724834</span></span>
<span><span class="co">## 3           1     7       59       car  7.9375438</span></span>
<span><span class="co">## 4           1   153       62       car -0.9975663</span></span>
<span><span class="co">## 5           1   104       63       car 13.9909229</span></span>
<span><span class="co">## 6           1    13       65       car  0.6623084</span></span></code></pre>
<ul>
<li>
<p>Define model formula:</p>
<ul>
<li>
<p><strong>Fixed effects</strong> :</p>
<ul>
<li><p>Everything after <code>~</code> but not in paranthesis</p></li>
<li><p>Capture intercept and predictor effect <em>across</em>
subjects</p></li>
<li><p>Usually our effects of interest</p></li>
</ul>
</li>
<li>
<p><strong>Random effects</strong>:</p>
<ul>
<li><p>Everything in parentheses</p></li>
<li><p>Capture subject-specific variation in the intercept and in the
predictor effect</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">form_lmm</span> <span class="op">&lt;-</span> <span class="va">amplitude</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">condition</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">condition</span> <span class="op">|</span> <span class="va">participant</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">stimulus</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>Fit linear mixed model:</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_lmm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">form_lmm</span>, <span class="va">dat_group</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod_lmm</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Linear mixed model fit by REML. t-tests use Satterthwaite's method [</span></span>
<span><span class="co">## lmerModLmerTest]</span></span>
<span><span class="co">## Formula: form_lmm</span></span>
<span><span class="co">##    Data: dat_group</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## REML criterion at convergence: 17443.8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Scaled residuals: </span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -3.6623 -0.6399 -0.0111  0.6071  5.1587 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##  Groups      Name          Variance Std.Dev. Corr </span></span>
<span><span class="co">##  stimulus    (Intercept)    0.0577  0.2402        </span></span>
<span><span class="co">##  participant (Intercept)    7.2924  2.7005        </span></span>
<span><span class="co">##              conditionface  3.8341  1.9581   -0.30</span></span>
<span><span class="co">##  Residual                  21.1225  4.5959        </span></span>
<span><span class="co">## Number of obs: 2933, groups:  stimulus, 80; participant, 39</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fixed effects:</span></span>
<span><span class="co">##               Estimate Std. Error      df t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)     0.6123     0.4640 34.9313   1.320    0.196    </span></span>
<span><span class="co">## conditionface  -1.9520     0.3799 36.7326  -5.138 9.37e-06 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Correlation of Fixed Effects:</span></span>
<span><span class="co">##             (Intr)</span></span>
<span><span class="co">## conditionfc -0.365</span></span></code></pre>
<ul>
<li>Conclusion: In the population from which the ERP CORE participants
were drawn, face images (as compared to car images) elicit more negative
voltages in the N170 time range</li>
</ul>
</div>
<div class="section level2">
<h2 id="repeated-measures-anova">7.5 Repeated measures ANOVA<a class="anchor" aria-label="anchor" href="#repeated-measures-anova"></a>
</h2>
<ul>
<li><p>LMMs used to be difficult to fit before modern computer
hardware</p></li>
<li>
<p>“Traditional” approach:</p>
<ul>
<li><p>For each subject, average all trials from the same
condition</p></li>
<li><p>Then model the condition effect as a factor in an <a href="https://en.wikipedia.org/wiki/Random_effects_model" class="external-link"><strong>repeated
measures analysis of variance (rmANOVA)</strong></a></p></li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat_ave</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">amplitude</span> <span class="op">~</span> <span class="va">participant</span> <span class="op">+</span> <span class="va">condition</span>, <span class="va">dat_group</span>, <span class="va">mean</span><span class="op">)</span></span>
<span><span class="va">dat_ave</span><span class="op">$</span><span class="va">participant</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dat_ave</span><span class="op">$</span><span class="va">participant</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat_ave</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   participant condition  amplitude</span></span>
<span><span class="co">## 1           1       car  1.8409519</span></span>
<span><span class="co">## 2           2       car -1.7206263</span></span>
<span><span class="co">## 3           3       car  4.4435237</span></span>
<span><span class="co">## 4           4       car -0.1552853</span></span>
<span><span class="co">## 5           5       car 10.0162948</span></span>
<span><span class="co">## 6           6       car -0.8758355</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_aov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="va">amplitude</span> <span class="op">~</span> <span class="va">condition</span> <span class="op">+</span> <span class="fu">Error</span><span class="op">(</span><span class="va">participant</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">dat_ave</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod_aov</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Error: participant</span></span>
<span><span class="co">##           Df Sum Sq Mean Sq F value Pr(&gt;F)</span></span>
<span><span class="co">## Residuals 38  610.1   16.05               </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Error: Within</span></span>
<span><span class="co">##           Df Sum Sq Mean Sq F value   Pr(&gt;F)    </span></span>
<span><span class="co">## condition  1  72.81   72.81    22.8 2.67e-05 ***</span></span>
<span><span class="co">## Residuals 38 121.33    3.19                     </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre>
<ul>
<li>In the case of a single predictor variable with two levels, this is
equivalent to a paired <em>t</em>-test:</li>
</ul>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">amplitude</span> <span class="op">~</span> <span class="va">condition</span>, data <span class="op">=</span> <span class="va">dat_ave</span>, paired <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Paired t-test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  amplitude by condition</span></span>
<span><span class="co">## t = 4.7752, df = 38, p-value = 2.673e-05</span></span>
<span><span class="co">## alternative hypothesis: true mean difference is not equal to 0</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  1.113088 2.751419</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">## mean difference </span></span>
<span><span class="co">##        1.932254</span></span></code></pre>
<ul>
<li>
<p>Note that rmANOVA has a number of drawbacks compared to a mixed
model:</p>
<ul>
<li><p>Independence assumption violated because participant effects and
item effects cannot be accounted for simultanously<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Bürki, A., Frossard, J., &amp;amp; Renaud, O. (2018).
Accounting for stimulus and participant effects in event-related
potential analyses to increase the replicability of studies. &lt;em&gt;Journal
of Neuroscience Methods&lt;/em&gt;, &lt;em&gt;309&lt;/em&gt;, 218–227. &lt;a href="https://doi.org/10.1016/j.jneumeth.2018.09.016" class="external-link uri"&gt;https://doi.org/10.1016/j.jneumeth.2018.09.016&lt;/a&gt;&lt;/p&gt;'><sup>5</sup></a></p></li>
<li><p>Not robust to unbalanced designs (i.e., different numbers of
trials per condition and/or per participant)</p></li>
<li><p>Cannot include trial-level covariates (e.g., fatigue)</p></li>
<li><p>Cannot include item-level covariates (e.g., word length)</p></li>
</ul>
</li>
</ul>
<p><img src="images/anova_lmm.jpg" width="300"></p>
<p><em><strong>Figure:</strong> Mixed models are becoming the standard
tool for analyzing data in experimental psychology.</em><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;strong&gt;Source:&lt;/strong&gt; &lt;a href="https://imgflip.com/memegenerator/Left-Exit-12-Off-Ramp" class="external-link"&gt;imgflip
Meme Generator&lt;/a&gt;&lt;/p&gt;'><sup>6</sup></a></p>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
