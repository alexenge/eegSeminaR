<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="eegSeminaR">
<title>3. Preprocessing ‚Ä¢ eegSeminaR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="3. Preprocessing">
<meta property="og:description" content="eegSeminaR">
<meta property="og:image" content="https://alexenge.github.io/eegSeminaR/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">eegSeminaR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2022.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/eegSeminaR.html">Get started</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-course-contents">Course contents</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-course-contents">
    <a class="dropdown-item" href="../articles/v1-introduction-to-r.html">1. Introduction to R</a>
    <a class="dropdown-item" href="../articles/v2-open-data.html">2. Open data</a>
    <a class="dropdown-item" href="../articles/v3-preprocessing.html">3. Preprocessing</a>
    <a class="dropdown-item" href="../articles/v4-creating-epochs.html">4. Creating epochs</a>
    <a class="dropdown-item" href="../articles/v5-removing-artifacts.html">5. Removing artifacts</a>
    <a class="dropdown-item" href="../articles/v6-extracting-amplitudes.html">6. Extracting amplitudes</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/alexenge/eegSeminaR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="v3-preprocessing_files/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="v3-preprocessing_files/plotly-binding-4.10.1/plotly.js"></script><script src="v3-preprocessing_files/typedarray-0.1/typedarray.min.js"></script><link href="v3-preprocessing_files/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="v3-preprocessing_files/crosstalk-1.2.0/js/crosstalk.min.js"></script><link href="v3-preprocessing_files/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="v3-preprocessing_files/plotly-main-2.11.1/plotly-latest.min.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>3. Preprocessing</h1>
            
            <h4 data-toc-skip class="date">2022-12-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/alexenge/eegSeminaR/blob/HEAD/vignettes/v3-preprocessing.Rmd" class="external-link"><code>vignettes/v3-preprocessing.Rmd</code></a></small>
      <div class="d-none name"><code>v3-preprocessing.Rmd</code></div>
    </div>

    
    
<blockquote>
<p>üéØ <strong>GOALS</strong></p>
<p><em>Learning to use the R package <code>eegUtils</code> for loading,
viewing, and cleaning EEG data so that it can be used for event-related
potential (ERP) analysis.</em></p>
</blockquote>
<div class="section level2">
<h2 id="intro-recipes">3.1 Intro: Recipes<a class="anchor" aria-label="anchor" href="#intro-recipes"></a>
</h2>
<ul>
<li><p>Data analysis is like cooking: We take raw ingredients (data) and
transform them according to a semi-standardized procedure into a tasty
meal (an academic paper or thesis)</p></li>
<li><p>Every step in the recipe affords ‚Äúresearchers degrees of freedom‚Äù
‚Äì problematic if undisclosed<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;See Simmons, J. P., Nelson, L. D., &amp;amp; Simonsohn, U.
(2011). False-positive psychology: Undisclosed flexibility in data
collection and analysis allows presenting anything as significant.
&lt;em&gt;Psychological Science&lt;/em&gt;, &lt;em&gt;22&lt;/em&gt;(11), 1359‚Äì1366. &lt;a href="https://doi.org/10.1177/0956797611417632" class="external-link uri"&gt;https://doi.org/10.1177/0956797611417632&lt;/a&gt;&lt;/p&gt;'><sup>1</sup></a></p></li>
</ul>
<p><img src="images/recipe.png" width="800"></p>
<p><em><strong>Figure:</strong> Every comment on every recipe on the
internet ever.</em><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;strong&gt;Source:&lt;/strong&gt; &lt;a href="https://www.instructables.com/The-BEST-chococlate-cake-ever...that-happens-to-be/" class="external-link"&gt;instructables
cooking&lt;/a&gt;&lt;/p&gt;'><sup>2</sup></a></p>
</div>
<div class="section level2">
<h2 id="loading-data">3.2 Loading data<a class="anchor" aria-label="anchor" href="#loading-data"></a>
</h2>
<ul>
<li>
<p>First load required packages:</p>
<ul>
<li><p><code>here</code> for working with file paths</p></li>
<li><p><code>eegUtils</code><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Craddock, M. (2022). &lt;em&gt;eegUtils: Utilities for
electroencephalographic (EEG) analysis&lt;/em&gt; (0.7.0). &lt;a href="https://craddm.github.io/eegUtils" class="external-link uri"&gt;https://craddm.github.io/eegUtils&lt;/a&gt;&lt;/p&gt;'><sup>3</sup></a> for working with EEG data</p></li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/" class="external-link">here</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/craddm/eegUtils" class="external-link">eegUtils</a></span><span class="op">)</span></span></code></pre></div>
<ul>
<li><p>Downloaded ERP CORE data is in <code>data/n170</code> (see
Section 2.5)</p></li>
<li><p>Data is in BIDS format; each subject has it‚Äôs own
<code>sub-XXX/eeg</code> sub-directory</p></li>
<li><p>We need to find the <code>.set</code> file for loading the EEG
data:</p></li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bids_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"data/n170"</span><span class="op">)</span></span>
<span><span class="va">set_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="va">bids_dir</span>, <span class="st">"sub-001/eeg/sub-001_task-N170_eeg.set"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">set_file</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<ul>
<li>
<code>eegUtils</code> has functions for loading (‚Äúimporting‚Äù) raw
EEG data from various file formats into R, including the
<code>.set</code> format used by ERP CORE</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">dat_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://craddm.github.io/eegUtils/reference/import_set.html" class="external-link">import_set</a></span><span class="op">(</span><span class="va">set_file</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Importing from EEGLAB .set file.</span></span></code></pre>
<pre><code><span><span class="co">## Importing data from .fdt file.</span></span></code></pre>
<pre><code><span><span class="co">## EEG data</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of channels   : 33 </span></span>
<span><span class="co">## Electrode names      : FP1 F3 F7 FC3 C3 C5 P3 P7 P9 PO7 PO3 O1 Oz Pz CPz FP2 Fz F4 F8 FC4 FCz Cz C4 C6 P4 P8 P10 PO8 PO4 O2 HEOG_left HEOG_right VEOG_lower </span></span>
<span><span class="co">## Sampling rate        : 1024 Hz</span></span>
<span><span class="co">## Reference        : </span></span>
<span><span class="co">## Signal length: 0 682.999 seconds</span></span></code></pre>
<ul>
<li>See what type of data we‚Äôve got:</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">dat_raw</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "eeg_data"</span></span></code></pre>
<ul>
<li>
<code>eeg_data</code> is a custom class defined by
<code>eegUtils</code> ‚Äì a big list with many sub-components:</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">dat_raw</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 8</span></span>
<span><span class="co">##  $ signals  :'data.frame':   699392 obs. of  33 variables:</span></span>
<span><span class="co">##   ..$ FP1       : num [1:699392] -2503 -2502 -2502 -2503 -2504 ...</span></span>
<span><span class="co">##   ..$ F3        : num [1:699392] 1898 1899 1896 1897 1895 ...</span></span>
<span><span class="co">##   ..$ F7        : num [1:699392] 12316 12314 12310 12308 12305 ...</span></span>
<span><span class="co">##   ..$ FC3       : num [1:699392] 2694 2696 2695 2695 2693 ...</span></span>
<span><span class="co">##   ..$ C3        : num [1:699392] 3794 3794 3794 3794 3793 ...</span></span>
<span><span class="co">##   ..$ C5        : num [1:699392] 7308 7308 7308 7309 7308 ...</span></span>
<span><span class="co">##   ..$ P3        : num [1:699392] -328 -328 -329 -329 -329 ...</span></span>
<span><span class="co">##   ..$ P7        : num [1:699392] -471 -471 -472 -472 -473 ...</span></span>
<span><span class="co">##   ..$ P9        : num [1:699392] 250 252 252 249 246 ...</span></span>
<span><span class="co">##   ..$ PO7       : num [1:699392] -2770 -2767 -2765 -2762 -2763 ...</span></span>
<span><span class="co">##   ..$ PO3       : num [1:699392] -3285 -3285 -3284 -3283 -3283 ...</span></span>
<span><span class="co">##   ..$ O1        : num [1:699392] -6382 -6383 -6383 -6380 -6377 ...</span></span>
<span><span class="co">##   ..$ Oz        : num [1:699392] -5855 -5852 -5848 -5846 -5847 ...</span></span>
<span><span class="co">##   ..$ Pz        : num [1:699392] 3699 3699 3698 3699 3699 ...</span></span>
<span><span class="co">##   ..$ CPz       : num [1:699392] 1347 1347 1345 1345 1345 ...</span></span>
<span><span class="co">##   ..$ FP2       : num [1:699392] 959 962 965 967 967 ...</span></span>
<span><span class="co">##   ..$ Fz        : num [1:699392] 9392 9393 9392 9392 9391 ...</span></span>
<span><span class="co">##   ..$ F4        : num [1:699392] 4989 4989 4990 4990 4989 ...</span></span>
<span><span class="co">##   ..$ F8        : num [1:699392] 9311 9311 9311 9311 9309 ...</span></span>
<span><span class="co">##   ..$ FC4       : num [1:699392] 8402 8403 8404 8405 8403 ...</span></span>
<span><span class="co">##   ..$ FCz       : num [1:699392] 5594 5595 5595 5596 5594 ...</span></span>
<span><span class="co">##   ..$ Cz        : num [1:699392] 171 171 171 170 168 ...</span></span>
<span><span class="co">##   ..$ C4        : num [1:699392] 4092 4093 4093 4093 4092 ...</span></span>
<span><span class="co">##   ..$ C6        : num [1:699392] 1757 1758 1758 1758 1756 ...</span></span>
<span><span class="co">##   ..$ P4        : num [1:699392] -1050 -1049 -1050 -1050 -1051 ...</span></span>
<span><span class="co">##   ..$ P8        : num [1:699392] -3165 -3161 -3160 -3160 -3161 ...</span></span>
<span><span class="co">##   ..$ P10       : num [1:699392] 22439 22441 22442 22445 22446 ...</span></span>
<span><span class="co">##   ..$ PO8       : num [1:699392] -5183 -5177 -5172 -5167 -5166 ...</span></span>
<span><span class="co">##   ..$ PO4       : num [1:699392] -5888 -5886 -5885 -5885 -5885 ...</span></span>
<span><span class="co">##   ..$ O2        : num [1:699392] -4763 -4760 -4760 -4757 -4753 ...</span></span>
<span><span class="co">##   ..$ HEOG_left : num [1:699392] 5347 5343 5334 5327 5322 ...</span></span>
<span><span class="co">##   ..$ HEOG_right: num [1:699392] 4003 4003 4002 4000 3996 ...</span></span>
<span><span class="co">##   ..$ VEOG_lower: num [1:699392] 4875 4875 4874 4871 4868 ...</span></span>
<span><span class="co">##  $ srate    : num 1024</span></span>
<span><span class="co">##  $ events   : tibble [640 √ó 4] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">##   ..$ event_type : num [1:640] 202 202 79 201 73 201 75 201 112 201 ...</span></span>
<span><span class="co">##   ..$ event_onset: num [1:640] 1682 11029 15412 16091 16998 ...</span></span>
<span><span class="co">##   ..$ urevent    : num [1:640] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">##   ..$ event_time : num [1:640] 1.64 10.77 15.05 15.71 16.6 ...</span></span>
<span><span class="co">##  $ chan_info:'data.frame':   33 obs. of  9 variables:</span></span>
<span><span class="co">##   ..$ electrode: chr [1:33] "FP1" "F3" "F7" "FC3" ...</span></span>
<span><span class="co">##   ..$ radius   : num [1:33] 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##   ..$ theta    : num [1:33] NA NA NA NA NA NA NA NA NA NA ...</span></span>
<span><span class="co">##   ..$ phi      : num [1:33] NA NA NA NA NA NA NA NA NA NA ...</span></span>
<span><span class="co">##   ..$ cart_x   : int [1:33] NA NA NA NA NA NA NA NA NA NA ...</span></span>
<span><span class="co">##   ..$ cart_y   : logi [1:33] NA NA NA NA NA NA ...</span></span>
<span><span class="co">##   ..$ cart_z   : logi [1:33] NA NA NA NA NA NA ...</span></span>
<span><span class="co">##   ..$ x        : num [1:33] NA NA NA NA NA NA NA NA NA NA ...</span></span>
<span><span class="co">##   ..$ y        : num [1:33] NA NA NA NA NA NA NA NA NA NA ...</span></span>
<span><span class="co">##  $ timings  : tibble [699,392 √ó 2] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">##   ..$ time  : num [1:699392] 0 0.000977 0.001953 0.00293 0.003906 ...</span></span>
<span><span class="co">##   ..$ sample: int [1:699392] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">##  $ reference: NULL</span></span>
<span><span class="co">##  $ epochs   : epoch_nf [1 √ó 3] (S3: epoch_info/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">##   ..$ epoch         : int 1</span></span>
<span><span class="co">##   ..$ participant_id: chr "sub-001_task-N170_eeg"</span></span>
<span><span class="co">##   ..$ recording     : chr "sub-001_task-N170_eeg"</span></span>
<span><span class="co">##  $ version  :Classes 'package_version', 'numeric_version'  hidden list of 1</span></span>
<span><span class="co">##   ..$ : int [1:3] 0 7 0</span></span>
<span><span class="co">##  - attr(*, "class")= chr "eeg_data"</span></span></code></pre>
<ul>
<li>
<p>The <strong>actual EEG data</strong> are in a data frame called
<code>signals</code></p>
<ul>
<li><p>Each <strong>row</strong> is one <strong>sample</strong> (time
point)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Technically, the EEG gets recorded by the EEG electrodes
in a &lt;em&gt;continuous&lt;/em&gt; (analog) fashion. The &lt;em&gt;discrete&lt;/em&gt; time
steps that we‚Äôre dealing with here were created by the EEG amplifier
during the &lt;em&gt;digitization&lt;/em&gt; step of the online EEG recording.&lt;/p&gt;"><sup>4</sup></a></p></li>
<li><p>Each <strong>column</strong> is one <strong>channel</strong> (EEG
electrode)</p></li>
<li><p>Each <strong>value</strong> is the <strong>EEG voltage</strong>
(in microvolts; ¬µV) measured at this time sample and channel</p></li>
</ul>
</li>
<li><p>Other elements contain useful <strong>meta-information</strong>,
some of which used in later sections</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="viewing-data">3.3 Viewing data<a class="anchor" aria-label="anchor" href="#viewing-data"></a>
</h2>
<ul>
<li>Usually a good idea to <strong>visually check the data</strong> at
the outset of data analysis and at multiple steps throughout</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="http://craddm.github.io/eegUtils/reference/browse_data.html" class="external-link">browse_data</a></span><span class="op">(</span><span class="va">dat_raw</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>Check out multiple time points (‚ÄúDisplay start time‚Äù) and switch
between the ‚ÄúIndividual‚Äù view and the ‚ÄúButterfly‚Äù</li>
<li>Remember to click ‚ÄúDone‚Äù or you will not be able run the next piece
of code</li>
</ul>
<blockquote>
<p>‚úçÔ∏è <strong>EXERCISE</strong></p>
<p><em>Inspect the data at different time points and channels. Note down
any features of data you find interesting and potentially relevant to
deal with in our analysis.</em></p>
</blockquote>
<ul>
<li>Static ‚Äúbutterfly‚Äù plot of a chunk of data:</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">time_lim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">305</span><span class="op">)</span></span>
<span><span class="fu"><a href="http://craddm.github.io/eegUtils/reference/plot_butterfly.html" class="external-link">plot_butterfly</a></span><span class="op">(</span><span class="va">dat_raw</span>, <span class="va">time_lim</span>, baseline <span class="op">=</span> <span class="va">time_lim</span><span class="op">)</span></span></code></pre></div>
<p><img src="v3-preprocessing_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="channel-locations">3.4 Channel locations<a class="anchor" aria-label="anchor" href="#channel-locations"></a>
</h2>
<ul>
<li><p>For some steps (e.g., making topographic plots) we need to know
the <strong>relative positions of electrodes</strong> on the
scalp</p></li>
<li><p>Sometimes included in the raw data, but here we need to use a
separate function<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;The &lt;code&gt;"biosemi64"&lt;/code&gt; locations are provided by
&lt;code&gt;eegUtils&lt;/code&gt;, but we could also have used the
&lt;code&gt;electrodes.tsv&lt;/code&gt; file from the BIDS structure.&lt;/p&gt;'><sup>5</sup></a></p></li>
</ul>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://craddm.github.io/eegUtils/reference/electrode_locations.html" class="external-link">electrode_locations</a></span><span class="op">(</span><span class="va">dat_raw</span>, montage <span class="op">=</span> <span class="st">"biosemi64"</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Electrodes not found: HEOG_left HEOG_right VEOG_lower</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat_raw</span><span class="op">$</span><span class="va">chan_info</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 33 √ó 9</span></span></span>
<span><span class="co">##    electrode radius theta   phi cart_x cart_y cart_z     x     y</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> FP1            1   -<span style="color: #BB0000;">92</span>   -<span style="color: #BB0000;">72</span>  -<span style="color: #BB0000;">26.2</span>   80.8  -<span style="color: #BB0000;">2.97</span> -<span style="color: #BB0000;">28.4</span>  87.5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> F3             1   -<span style="color: #BB0000;">60</span>   -<span style="color: #BB0000;">51</span>  -<span style="color: #BB0000;">46.3</span>   57.2  42.5  -<span style="color: #BB0000;">37.8</span>  46.6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> F7             1   -<span style="color: #BB0000;">92</span>   -<span style="color: #BB0000;">36</span>  -<span style="color: #BB0000;">68.7</span>   49.9  -<span style="color: #BB0000;">2.97</span> -<span style="color: #BB0000;">74.4</span>  54.1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> FC3            1   -<span style="color: #BB0000;">50</span>   -<span style="color: #BB0000;">28</span>  -<span style="color: #BB0000;">57.5</span>   30.6  54.6  -<span style="color: #BB0000;">44.2</span>  23.5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> C3             1   -<span style="color: #BB0000;">46</span>     0  -<span style="color: #BB0000;">61.1</span>    0    59.0  -<span style="color: #BB0000;">46</span>     0  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> C5             1   -<span style="color: #BB0000;">69</span>     0  -<span style="color: #BB0000;">79.4</span>    0    30.5  -<span style="color: #BB0000;">69</span>     0  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> P3             1   -<span style="color: #BB0000;">60</span>    51  -<span style="color: #BB0000;">46.3</span>  -<span style="color: #BB0000;">57.2</span>  42.5  -<span style="color: #BB0000;">37.8</span> -<span style="color: #BB0000;">46.6</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> P7             1   -<span style="color: #BB0000;">92</span>    36  -<span style="color: #BB0000;">68.7</span>  -<span style="color: #BB0000;">49.9</span>  -<span style="color: #BB0000;">2.97</span> -<span style="color: #BB0000;">74.4</span> -<span style="color: #BB0000;">54.1</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> P9             1  -<span style="color: #BB0000;">115</span>    36  -<span style="color: #BB0000;">62.3</span>  -<span style="color: #BB0000;">45.3</span> -<span style="color: #BB0000;">35.9</span>  -<span style="color: #BB0000;">93.0</span> -<span style="color: #BB0000;">67.6</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> PO7            1   -<span style="color: #BB0000;">92</span>    54  -<span style="color: #BB0000;">49.9</span>  -<span style="color: #BB0000;">68.7</span>  -<span style="color: #BB0000;">2.97</span> -<span style="color: #BB0000;">54.1</span> -<span style="color: #BB0000;">74.4</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ‚Ä¶ with 23 more rows</span></span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="http://craddm.github.io/eegUtils/reference/plot_electrodes.html" class="external-link">plot_electrodes</a></span><span class="op">(</span><span class="va">dat_raw</span>, interact <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-1da6f5951cd470f9f7d4" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1da6f5951cd470f9f7d4">{"x":{"visdat":{"19827926e760":["function () ","plotlyVisDat"]},"cur_data":"19827926e760","attrs":{"19827926e760":{"x":{},"y":{},"z":{},"text":{},"mode":"text+markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"cart_x"},"yaxis":{"title":"cart_y"},"zaxis":{"title":"cart_z"}},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-26.25,-46.33,-68.72,-57.49,-61.14,-79.35,-46.33,-68.72,-62.32,-49.93,-34.53,-26.25,0,0,0,26.25,0,46.33,68.72,57.49,0,0,61.14,79.35,46.33,68.72,62.32,49.93,34.53,26.25],"y":[80.79,57.21,49.93,30.57,0,0,-57.21,-49.93,-45.28,-68.72,-74.05,-80.79,-84.95,-61.14,-33.21,80.79,61.14,57.21,49.93,30.57,33.21,0,0,0,-57.21,-49.93,-45.28,-68.72,-74.05,-80.79],"z":[-2.97,42.5,-2.97,54.64,59.05,30.46,42.5,-2.97,-35.92,-2.97,23.43,-2.97,-2.97,59.05,78.24,-2.97,59.05,42.5,-2.97,54.64,78.24,85,59.05,30.46,42.5,-2.97,-35.92,-2.97,23.43,-2.97],"text":["FP1","F3","F7","FC3","C3","C5","P3","P7","P9","PO7","PO3","O1","Oz","Pz","CPz","FP2","Fz","F4","F8","FC4","FCz","Cz","C4","C6","P4","P8","P10","PO8","PO4","O2"],"mode":"text+markers","type":"scatter3d","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="re-referencing">3.5 Re-referencing<a class="anchor" aria-label="anchor" href="#re-referencing"></a>
</h2>
<ul>
<li><p>During recording (‚Äúonline‚Äù), each electrode is measuring the
<em>difference</em> in voltage compared to the reference electrode
(e.g., FCz)</p></li>
<li>
<p>During preprocessing (‚Äúoffline‚Äù), we typically choose a new
reference:</p>
<ul>
<li><p><strong>Average reference</strong>: Difference to the average of
all scalp channels</p></li>
<li><p><strong>Linked mastoids</strong>: Difference to the average of
the mastoid channels (M1 and M2)</p></li>
</ul>
</li>
</ul>
<p><img src="https://pressrelease.brainproducts.com/wp-content/uploads/2022/01/Rereferencing_in_Analyzer_1.png" width="800"></p>
<p><em><strong>Figure:</strong> Different reference schemes.</em><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;strong&gt;Source:&lt;/strong&gt; &lt;a href="https://pressrelease.brainproducts.com/referencing/" class="external-link"&gt;Laura Leuchs,
Brain Products&lt;/a&gt;&lt;/p&gt;'><sup>6</sup></a></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eog_channels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HEOG_left"</span>, <span class="st">"HEOG_right"</span>, <span class="st">"VEOG_lower"</span><span class="op">)</span></span>
<span><span class="va">dat_reref</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://craddm.github.io/eegUtils/reference/eeg_reference.html" class="external-link">eeg_reference</a></span><span class="op">(</span><span class="va">dat_raw</span>, ref_chans <span class="op">=</span> <span class="st">"average"</span>, exclude <span class="op">=</span> <span class="va">eog_channels</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="filtering">3.6 Filtering<a class="anchor" aria-label="anchor" href="#filtering"></a>
</h2>
<ul>
<li>Insight by <strong>Joseph Fourier</strong> (1768‚Äì1830): Every
complex signal can be described by a sum of sine waves
<ul>
<li>The <strong>frequency</strong> (in Hz) of a sine wave describes how
fast it repeats itself</li>
</ul>
</li>
</ul>
<p><img src="images/fourier.png" width="600"></p>
<p><em><strong>Figure:</strong> Summing up of sine waves in the time and
frequency domains.</em><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;strong&gt;Source:&lt;/strong&gt; Enge, A. (2022).
&lt;em&gt;tfr-workshop: An introductory workshop on analyzing the
time-frequency content of EEG data&lt;/em&gt;. &lt;a href="https://github.com/alexenge/tfr-workshop" class="external-link uri"&gt;https://github.com/alexenge/tfr-workshop&lt;/a&gt;&lt;/p&gt;'><sup>7</sup></a></p>
<ul>
<li>The EEG too consists of different types of activity with different
frequencies:</li>
</ul>
<table class="table">
<thead><tr class="header">
<th>Frequency</th>
<th>EEG activity</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>&lt; 0.1 Hz</td>
<td>Electrode drift, sweat artifacts</td>
</tr>
<tr class="even">
<td>0.1‚Äì4 Hz (delta)</td>
<td>Slow-wave sleep</td>
</tr>
<tr class="odd">
<td>4‚Äì8 Hz (theta)</td>
<td>Drowsiness, idling</td>
</tr>
<tr class="even">
<td>8‚Äì13 Hz (alpha)</td>
<td>Relaxing, inhibition</td>
</tr>
<tr class="odd">
<td>13‚Äì30 Hz (beta)</td>
<td>Active thinking, alertness</td>
</tr>
<tr class="even">
<td>30‚Äì80 Hz (gamma)</td>
<td>Binding, consciousness (?)</td>
</tr>
<tr class="odd">
<td>50 Hz (US: 60 Hz)</td>
<td>Power line noise</td>
</tr>
<tr class="even">
<td>&gt; 80 Hz</td>
<td>Muscle artifacts</td>
</tr>
</tbody>
</table>
<ul>
<li><p>Most brain activity detectable with EEG happens between 0.1‚Äì30
Hz</p></li>
<li>
<p><strong>Filtering</strong> is used to remove unwanted parts of
the signal:</p>
<ol style="list-style-type: decimal">
<li>Convert time-domain EEG into the frequency domain (Fourier
transform)</li>
<li>Remove (resp. attenuate) certain frequencies
<ul>
<li><p>A <em>high-pass</em> filter remove slow frequencies (e.g., &lt;
0.1 Hz)</p></li>
<li><p>A <em>low-pass</em> filter removes fast frequencies (e.g., &gt;
30 Hz)</p></li>
<li><p>A <em>band-pass</em> filter combines a high-pass and low-pass
filter</p></li>
<li><p>A <em>band-stop</em> filter removes a narrow frequency range
(e.g., around 50 Hz)</p></li>
</ul>
</li>
<li>Convert ‚Äúcleaned‚Äù signal back into the time domain</li>
</ol>
</li>
</ul>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat_filt</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://craddm.github.io/eegUtils/reference/eeg_filter.html" class="external-link">eeg_filter</a></span><span class="op">(</span><span class="va">dat_reref</span>, low_freq <span class="op">=</span> <span class="fl">0.1</span>, high_freq <span class="op">=</span> <span class="fl">30.0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Band-pass FIR filter from 0.1 - 30 Hz</span></span></code></pre>
<pre><code><span><span class="co">## Transition bandwidth: 0.1 Hz</span></span></code></pre>
<pre><code><span><span class="co">## Filter order: 33792</span></span></code></pre>
<pre><code><span><span class="co">## Removing channel means...</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="http://craddm.github.io/eegUtils/reference/plot_butterfly.html" class="external-link">plot_butterfly</a></span><span class="op">(</span><span class="va">dat_filt</span>, <span class="va">time_lim</span>, baseline <span class="op">=</span> <span class="va">time_lim</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Baseline: 300 sBaseline: 305 s</span></span></code></pre>
<p><img src="v3-preprocessing_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<blockquote>
<p>‚úçÔ∏è <strong>EXERCISE</strong></p>
<p><em>Use the data browser and compare the filtered data with the raw
data at a certain time point. Repeat the filtering step but making one
of the two cutoff frequencies more aggressive (that is, make either the
lower cutoff frequency higher or the higher cutoff frequency lower).
What advantages and disadvantages could this have?</em></p>
</blockquote>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">...</span></span></code></pre></div>
<blockquote>
<details><summary>
üí° <strong>NOTE: There‚Äôs a lot more to filters</strong>
</summary><p><em>While the idea of and the code for filtering looks simple, it is
actually a huge topic of research and debate. There are many different
types of filters and each of them has many more parameters than just
their cutoff frequency (e.g., filter length, transition bandwidth,
delay, direction).</em></p>
<p><em>Each of these parameters should be chosen such that the filter
(a) removes as much of the unwanted signals as possible while (b) not
distorting the part of the signal that we do care about. For example, it
has been shown that using a low-pass filter with too high a cutoff
(e.g., 1 Hz instead of 0.1 Hz) can introduce artificial ‚Äúbumps‚Äù in the
data that can be mistaken for true ERP components.</em><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;strong&gt;Source:&lt;/strong&gt; Tanner, D., Morgan-Short, K.,
&amp;amp; Luck, S. J. (2015). How inappropriate high-pass filters can
produce artifactual effects and incorrect conclusions in ERP studies of
language and cognition. &lt;em&gt;Psychophysiology&lt;/em&gt;, &lt;em&gt;52&lt;/em&gt;(8),
997‚Äì1009. &lt;a href="https://doi.org/10.1111/psyp.12437" class="external-link uri"&gt;https://doi.org/10.1111/psyp.12437&lt;/a&gt;&lt;/p&gt;'><sup>8</sup></a></p>
<p><img src="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4506207/bin/nihms671402f2.jpg" width="300"></p>
</details>
</blockquote>
<ul>
<li>Let‚Äôs save our preprocessed (re-referenced and filtered) data for
the next step<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;There‚Äôs not yet a final standard for the organization of
BIDS derivatives, that is, for processed outputs produced from BIDS
data. Here we‚Äôll loosely follow the BIDS conventions (e.g., using a
subject-specific &lt;code&gt;eeg&lt;/code&gt; folder), but we‚Äôll also cut some
corners (e.g., not creating &lt;code&gt;.json&lt;/code&gt; metadata) to save time.&lt;/p&gt;"><sup>9</sup></a>
</li>
</ul>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">deriv_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="va">bids_dir</span>, <span class="st">"derivatives/eegUtils/sub-001/eeg"</span><span class="op">)</span></span>
<span><span class="va">preproc_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="va">deriv_dir</span>, <span class="st">"sub-001_task-N170_desc-preprocessed_eeg.rds"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">deriv_dir</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">dat_filt</span>, <span class="va">preproc_file</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="further-reading">Further reading<a class="anchor" aria-label="anchor" href="#further-reading"></a>
</h2>
<ul>
<li>Newman, A. J., Godfrey, D., &amp; Post, R. (2022). EEG-ERP
Preprocessing. In <em>Data Science for Psychology and Neuroscience ‚Äì in
Python</em>. Dalhousie University. <a href="https://neuraldatascience.io/7-eeg/erp_preprocessing.html" class="external-link uri">https://neuraldatascience.io/7-eeg/erp_preprocessing.html</a>
</li>
<li>Delorme, A. (2022). <em>EEG is better left alone</em>
(p.¬†2022.12.03.518987). bioRxiv. <a href="https://doi.org/10.1101/2022.12.03.518987" class="external-link uri">https://doi.org/10.1101/2022.12.03.518987</a>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="add-on-topics">Add-on topics<a class="anchor" aria-label="anchor" href="#add-on-topics"></a>
</h2>
<div class="section level3">
<h3 id="downsampling">3.7 Downsampling<a class="anchor" aria-label="anchor" href="#downsampling"></a>
</h3>
<ul>
<li>The <strong>sampling rate</strong> defines the number of EEG
voltages recorded per second (= Hertz)</li>
</ul>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat_raw</span><span class="op">$</span><span class="va">srate</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1024</span></span></code></pre>
<ul>
<li>This means that each pair of samples is less than 1 ms apart!</li>
</ul>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">/</span> <span class="va">dat_raw</span><span class="op">$</span><span class="va">srate</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.0009765625</span></span></code></pre>
<ul>
<li>We typically don‚Äôt need <em>that</em> much temporal resolution,<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;This is because both the &lt;em&gt;cognitive processes&lt;/em&gt;
that we are interested in (e.g., perception, language, memory) and the
&lt;em&gt;biological processes&lt;/em&gt; that we detect with the EEG (mostly
post-synaptic potentials) unfold on the orders of 10‚Äì100 ms rather than
1 ms.&lt;/p&gt;"><sup>10</sup></a> so it
is often useful to <strong>downsample</strong> the data</li>
</ul>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat_downs</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://craddm.github.io/eegUtils/reference/eeg_downsample.html" class="external-link">eeg_downsample</a></span><span class="op">(</span><span class="va">dat_filt</span>, q <span class="op">=</span> <span class="fl">4.0</span><span class="op">)</span> <span class="co"># q is the downsampling factor</span></span></code></pre></div>
<pre><code><span><span class="co">## Downsampling from 1024Hz to 256Hz.</span></span></code></pre>
<ul>
<li>This reduces our computer‚Äôs memory load and will make subsequent
computations faster</li>
</ul>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">show_size_mb</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/object.size.html" class="external-link">object.size</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, units <span class="op">=</span> <span class="st">"MB"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>before <span class="op">=</span> <span class="va">dat_filt</span>, after <span class="op">=</span> <span class="va">dat_downs</span><span class="op">)</span>, <span class="va">show_size_mb</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $before</span></span>
<span><span class="co">## [1] "184.1 Mb"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $after</span></span>
<span><span class="co">## [1] "46.1 Mb"</span></span></code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">dat_downs</span>, <span class="va">preproc_file</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://i.imgflip.com/6xle88.jpg" fig-align="center" width="300"></p>
<p><em><strong>Figure:</strong> Moderate downsampling typically doesn‚Äôt
affect future plots or statistical results.</em><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;strong&gt;Source:&lt;/strong&gt; &lt;a href="https://imgflip.com/memegenerator/174489685/They-are-the-same-picture" class="external-link"&gt;imgflip
Meme Generator&lt;/a&gt;&lt;/p&gt;'><sup>11</sup></a></p>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
